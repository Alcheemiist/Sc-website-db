import requests
from bs4 import BeautifulSoup
import os
import re

def is_valid_filename(filename):
    return not bool(re.search(r'[\\/*?:"<>|]', filename))

# List of slugs
slugs = ["19-3011.01	Environmental Economists","17-3025.00	Environmental Engineering Technologists and Technicians","17-2081.00	Environmental Engineers","19-2041.02	Environmental Restoration Planners","19-4042.00	Environmental Science and Protection Technicians, Including Health","25-1053.00	Environmental Science Teachers, Postsecondary","19-2041.00	Environmental Scientists and Specialists, Including Health","19-1041.00	Epidemiologists","29-1128.00	Exercise Physiologists","29-1215.00	Family Medicine Physicians","17-2111.02	Fire-Prevention and Protection Engineers","19-4013.00	Food Science Technicians","19-1012.00	Food Scientists and Technologists","19-4092.00	Forensic Science Technicians","19-4071.00	Forest and Conservation Technicians","19-1032.00	Foresters","25-1043.00	Forestry and Conservation Science Teachers, Postsecondary","17-2141.01	Fuel Cell Engineers","29-1216.00	General Internal Medicine Physicians","29-9092.00	Genetic Counselors","19-1029.03	Geneticists","17-1022.01	Geodetic Surveyors","19-3092.00	Geographers","15-1299.02	Geographic Information Systems Technologists and Technicians","25-1064.00	Geography Teachers, Postsecondary","19-4043.00	Geological Technicians, Except Hydrologic Technicians","19-2042.00	Geoscientists, Except Hydrologists and Geographers","17-2111.00	Health and Safety Engineers, Except Mining Safety Engineers and Inspectors","15-1211.01	Health Informatics Specialists","29-9021.00	Health Information Technologists and Medical Registrars","25-1071.00	Health Specialties Teachers, Postsecondary","29-2099.00	Health Technologists and Technicians, All Other","29-1299.00	Healthcare Diagnosing or Treating Practitioners, All Other","29-9099.00	Healthcare Practitioners and Technical Workers, All Other","29-2092.00	Hearing Aid Specialists","29-2012.01	Histology Technicians","29-2011.04	Histotechnologists","29-1229.02	Hospitalists",
"17-2112.01	Human Factors Engineers and Ergonomists","19-4044.00	Hydrologic Technicians","19-2043.00	Hydrologists","19-2041.03	Industrial Ecologists","17-3026.00	Industrial Engineering Technologists and Technicians","17-2112.00	Industrial Engineers","19-3032.00	Industrial-Organizational Psychologists","15-1212.00	Information Security Analysts","15-1299.05	Information Security Engineers","15-1299.09	Information Technology Project Managers","17-1012.00	Landscape Architects","29-2061.00	Licensed Practical and Licensed Vocational Nurses","19-1099.00	Life Scientists, All Other","19-4099.00	Life, Physical, and Social Science Technicians, All Other","29-1122.01	Low Vision Therapists, Orientation and Mobility Specialists, and Vision Rehabilitation Therapists","29-2035.00	Magnetic Resonance Imaging Technologists","17-2112.03	Manufacturing Engineers","17-2121.00	Marine Engineers and Naval Architects",
"17-2131.00	Materials Engineers","19-2032.00	Materials Scientists","15-2099.00	Mathematical Science Occupations, All Other","25-1022.00	Mathematical Science Teachers, Postsecondary","15-2021.00	Mathematicians","17-3013.00	Mechanical Drafters","17-3027.00	Mechanical Engineering Technologists and Technicians","17-2141.00	Mechanical Engineers","17-2199.05	Mechatronics Engineers","29-2012.00	Medical and Clinical Laboratory Technicians","29-2011.00	Medical and Clinical Laboratory Technologists","11-9111.00	Medical and Health Services Managers","29-2036.00	Medical Dosimetrists","29-2072.00	Medical Records Specialists","19-1042.00	Medical Scientists, Except Epidemiologists","19-1022.00	Microbiologists","17-2199.06	Microsystems Engineers","29-9099.01	Midwives","17-2151.00	Mining and Geological Engineers, Including Mining Safety Engineers","19-1029.02	Molecular and Cellular Biologists","29-1129.02	Music Therapists","17-2199.09	Nanosystems Engineers","17-3026.01	Nanotechnology Engineering Technologists and Technicians","11-9121.00	Natural Sciences Managers","29-1299.01	Naturopathic Physicians","15-1244.00	Network and Computer Systems Administrators","29-2099.01	Neurodiagnostic Technologists","29-1217.00	Neurologists","19-3039.02	Neuropsychologists","17-3029.01	Non-Destructive Testing Specialists","17-2161.00	Nuclear Engineers","29-2033.00	Nuclear Medicine Technologists","19-4051.02	Nuclear Monitoring Technicians","19-4051.00	Nuclear Technicians","29-1151.00	Nurse Anesthetists","29-1161.00	Nurse Midwives","29-1171.00	Nurse Practitioners","25-1072.00	Nursing Instructors and Teachers, Postsecondary","29-1218.00	Obstetricians and Gynecologists","29-1122.00	Occupational Therapists","15-2031.00	Operations Research Analysts","29-2057.00	Ophthalmic Medical Technicians","29-2099.05	Ophthalmic Medical Technologists","29-1241.00	Ophthalmologists, Except Pediatric","29-2081.00	Opticians, Dispensing","29-1041.00	Optometrists","29-1022.00	Oral and Maxillofacial Surgeons","29-1023.00	Orthodontists","29-1242.00	Orthopedic Surgeons, Except Pediatric","29-1299.02	Orthoptists","29-2091.00	Orthotists and Prosthetists","29-2043.00	Paramedics","19-1031.03	Park Naturalists","29-2099.08	Patient Representatives","29-1243.00	Pediatric Surgeons","29-1221.00	Pediatricians, General","15-1299.04	Penetration Testers","17-2171.00	Petroleum Engineers","29-1051.00	Pharmacists","29-2052.00	Pharmacy Technicians","17-2199.07	Photonics Engineers","17-3029.08	Photonics Technicians","29-1229.04	Physical Medicine and Rehabilitation Physicians","19-2099.00	Physical Scientists, All Other","29-1123.00	Physical Therapists","29-1071.00	Physician Assistants","29-1229.00	Physicians, All Other","29-1222.00	Physicians, Pathologists","19-2012.00	Physicists","25-1054.00	Physics Teachers, Postsecondary","29-1081.00	Podiatrists","25-1065.00	Political Science Teachers, Postsecondary","19-3094.00	Political Scientists","19-4012.01	Precision Agriculture Technicians","29-1229.05	Preventive Medicine Physicians","29-1024.00	Prosthodontists","29-2053.00	Psychiatric Technicians","29-1223.00	Psychiatrists","19-3039.00	Psychologists, All Other","25-1066.00	Psychology Teachers, Postsecondary","19-4099.01	Quality Control Analysts","29-1124.00	Radiation Therapists","17-2072.01	Radio Frequency Identification Device Specialists","29-2034.00	Radiologic Technologists and Technicians","29-1224.00	Radiologists","19-1031.02	Range Managers","29-1125.00	Recreational Therapists","29-1141.00	Registered Nurses","19-2099.01	Remote Sensing Scientists and Technologists","19-4099.03	Remote Sensing Technicians","29-1126.00	Respiratory Therapists","17-2199.08	Robotics Engineers","17-3024.01	Robotics Technicians","41-9031.00	Sales Engineers","41-4011.00	Sales Representatives, Wholesale and Manufacturing, Technical and Scientific Products","19-3034.00	School Psychologists","19-4061.00	Social Science Research Assistants","25-1069.00	Social Sciences Teachers, Postsecondary, All Other","19-3099.00	Social Scientists and Related Workers, All Other","19-3041.00	Sociologists","25-1067.00	Sociology Teachers, Postsecondary","15-1252.00	Software Developers","15-1253.00	Software Quality Assurance Analysts and Testers","19-1013.00	Soil and Plant Scientists","17-2199.11	Solar Energy Systems Engineers","41-4011.07	Solar Sales Representatives and Assessors","29-1127.00	Speech-Language Pathologists","29-1229.06	Sports Medicine Physicians","15-2041.00	Statisticians","29-1249.00	Surgeons, All Other","29-9093.00	Surgical Assistants","29-2055.00	Surgical Technologists","19-3022.00	Survey Researchers","17-3031.00	Surveying and Mapping Technicians","17-1022.00	Surveyors","15-1241.01	Telecommunications Engineering Specialists","29-1129.00	Therapists, All Other","17-2051.01	Transportation Engineers","19-3099.01	Transportation Planners","19-3051.00	Urban and Regional Planners","29-1229.03	Urologists","17-2112.02	Validation Engineers","29-1131.00	Veterinarians","29-2056.00	Veterinary Technologists and Technicians","15-1255.01	Video Game Designers","11-9121.02	Water Resource Specialists","17-2051.02	Water/Wastewater Engineers","15-1299.01	Web Administrators","15-1255.00	Web and Digital Interface Designers","15-1254.00	Web Developers","17-2199.10	Wind Energy Engineers","19-1023.00	Zoologists and Wildlife Biologists"]

for slug in slugs:
    id = slug.split('\t')[0]
    file  = slug.split('\t')[1].strip()
    print(file)
    os.makedirs(file, exist_ok=True)

    url = 'https://www.onetonline.org/link/details/' + id
    # Fetch the page
    response = requests.get(url)
    soup = BeautifulSoup(response.content, 'html.parser')

    # Find all download links (assuming they are <a> tags with a specific class)
    for link in soup.find_all('a', class_='ms-2'):
        try:
            file_url = 'https://www.onetonline.org' + link['href']
            filename = f'./{file}/{file_url.split("/")[-1]}'
        except:
            continue

        # Download the file
        with requests.get(file_url, stream=True) as file_response:
            with open(filename, 'wb') as outfile:  # Changed 'file' to 'outfile'
                for chunk in file_response.iter_content(chunk_size=8192):
                    outfile.write(chunk)  # Changed 'file' to 'outfile'
job-details__description__content